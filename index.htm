<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">

<title>TrackerJS â€“ Embedded Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- ðŸš« INDEXING BLOCK -->
<meta name="robots" content="noindex, nofollow">
<meta name="googlebot" content="noindex, nofollow">

<meta name="description" content="TrackerJS embedded dashboard. Opens only inside authorized projects.">
<meta name="author" content="Akshat Prasad">

<!-- ðŸ” IFRAME-ONLY ACCESS CONTROL -->
<script>
(function () {
  const TRUSTED_HOST = "akshat-881236.github.io";
  const isIframe = window.self !== window.top;

  let refHost = "";
  try {
    refHost = document.referrer
      ? new URL(document.referrer).host
      : "";
  } catch {}

  const allowed =
    isIframe &&
    (refHost === TRUSTED_HOST || location.host === TRUSTED_HOST);

  if (!allowed) {
    document.documentElement.innerHTML = `
      <div style="
        height:100vh;
        display:flex;
        align-items:center;
        justify-content:center;
        background:#020617;
        color:#e5e7eb;
        font-family:system-ui,Arial;
        text-align:center;
        padding:30px;
      ">
        <div>
          <h2>TrackerJS</h2>
          <p><b>Embedded access only</b></p>
          <p>This dashboard works only inside authorized projects.</p>
          <p style="opacity:.7;margin-top:12px">
            No cookies â€¢ No tracking â€¢ Local-only
          </p>
        </div>
      </div>
    `;
    throw new Error("TrackerJS blocked: direct access");
  }
})();
</script>

<!-- ================= STYLES ================= -->
<style>
body{
  margin:0;
  font-family:system-ui,Segoe UI,Arial;
  background:#f8fafc;
  color:#111827;
}
header{
  background:#020617;
  color:#fff;
  padding:16px 20px;
}
main{padding:20px;}
footer{
  padding:16px 20px;
  font-size:13px;
  color:#6b7280;
  background:#f1f5f9;
}
.notice{
  background:#fff7ed;
  border-left:4px solid #f97316;
  padding:14px;
  border-radius:8px;
  margin-bottom:20px;
}
ul li{margin:6px 0;}
button{
  padding:8px 14px;
  border:none;
  border-radius:6px;
  background:#0f172a;
  color:#fff;
  cursor:pointer;
}
</style>

<!-- ================= DEPENDENCIES ================= -->
<script src="https://akshat-881236.github.io/TrackerJS/tracker.js"></script>
<script src="https://akshat-881236.github.io/TrackerJS/trackermeta.js"></script>
<script src="https://akshat-881236.github.io/TrackerJS/ui.js"></script>
<script src="https://akshat-881236.github.io/TrackerJS/index.js"></script>

</head>

<body>

<header>
  <h1>TrackerJS Dashboard</h1>
  <p style="margin:4px 0 0;font-size:14px">
    Embedded Visit Memory & Revisit Assistant
  </p>
</header>

<main>

  <div class="notice">
    <strong>Embedded Mode</strong>
    <p>
      TrackerJS runs fully on your device.
      No cookies, no analytics, no external tracking.
    </p>
  </div>

  <h2>Your Visit History</h2>
  <ul id="history">
    <li>Loading visit dataâ€¦</li>
  </ul>

  <button onclick="clearHistory()">Clear Local History</button>

</main>

<footer>
  TrackerJS Â· Client-side only Â· Privacy-first
</footer>

<script>
/* ================= RENDER HISTORY ================= */

function renderHistory(){
  const list = document.getElementById("history");

  if (!window.TrackerJS) {
    list.innerHTML = "<li>Tracker engine unavailable.</li>";
    return;
  }

  const data = TrackerJS.getHistory();

  if (!data.length) {
    list.innerHTML = "<li>No visit history found.</li>";
    return;
  }

  list.innerHTML = data.map(h => `
    <li>
      <b>${h.project}</b><br>
      <a href="${h.url}" target="_top">${h.url}</a>
      <small style="color:#6b7280">
        (${new Date(h.timestamp).toLocaleString()})
      </small>
    </li>
  `).join("");
}

function clearHistory(){
  TrackerJS.clearHistory();
  renderHistory();
}

setTimeout(renderHistory, 300);
</script>

</body>
</html>