  /* MIT License â€“ Akshat Network Hub
   Terms of Use & Privacy Policy Injector */

document.addEventListener("DOMContentLoaded", function () {
  "use strict";

  /* ===============================
     POLICY SETTINGS
  =============================== */
  const POLICY_SETTINGS = {
    enforce: false,               // true = cannot close
    rememberDismiss: true,        // store acknowledgment
    policyVersion: "1.0.0",       // ðŸ”¥ CHANGE ON POLICY UPDATE
    delay: 2000                   // ms before showing banner
  };

  const STORAGE_KEY = `anh_policy_ack_v${POLICY_SETTINGS.policyVersion}`;

  /* ===============================
     PROJECT DATABASE
  =============================== */
  const project_db = [
    {
      name: "Akshat Network Hub",
      prefix: "https://akshat-881236.github.io/",
      termsUrl: "https://akshat-881236.github.io/TrackerJS/terms.htm",
      privacyUrl: "https://akshat-881236.github.io/TrackerJS/privacy.htm",
      manualUrl: "https://akshat-881236.github.io/TrackerJS/usage-manual.htm"
    }
  ];

  const currentURL = window.location.href;

  const project = project_db.find(p =>
    currentURL.includes(p.prefix)
  );

  if (!project) return;

  /* ===============================
     DISMISS CHECK
  =============================== */
  if (
    !POLICY_SETTINGS.enforce &&
    POLICY_SETTINGS.rememberDismiss &&
    localStorage.getItem(STORAGE_KEY) === "true"
  ) {
    return;
  }

  /* ===============================
     CSS INJECTION
  =============================== */
  const style = document.createElement("style");
  style.textContent = `
  #anh-policy-band{
    position:fixed;
    top:0;left:0;
    width:100%;
    z-index:999999;
    display:flex;
    justify-content:center;
    pointer-events:none;
    font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
  }
  .anh-card{
    margin:10px;
    padding:14px 18px;
    max-width:1100px;
    width:95%;
    background:#0f172a;
    color:#e5e7eb;
    border-radius:14px;
    box-shadow:0 10px 40px rgba(0,0,0,.35);
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    animation:anhSlide .6s ease;
    pointer-events:auto;
  }
  @keyframes anhSlide{
    from{transform:translateY(-120%);opacity:0}
    to{transform:translateY(0);opacity:1}
  }
  .anh-text-group{
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    gap:10px;
    flex-grow:1;
  }
  .anh-text{
    font-size:14px;
    line-height:1.5;
  }
  .anh-text b{color:#38bdf8;}
  .anh-actions{
    display:flex;
    align-items:center;
    gap:8px;
  }
  .anh-btn{
    text-decoration:none;
    padding:7px 12px;
    border-radius:9px;
    font-size:13px;
    font-weight:600;
    white-space:nowrap;
    transition:.25s;
  }
  .anh-btn.secondary{
    background:#020617;
    color:#e5e7eb;
    border:1px solid #334155;
  }
  .anh-btn.secondary:hover{
    border-color:#38bdf8;
  }
  .anh-btn.primary{
    background:#38bdf8;
    color:#020617;
  }
  .anh-btn.primary:hover{
    background:#0ea5e9;
  }
  .anh-close{
    background:transparent;
    border:none;
    color:#94a3b8;
    font-size:18px;
    cursor:pointer;
    padding:6px 10px;
    border-radius:50%;
  }
  .anh-close:hover{
    background:#020617;
    color:#38bdf8;
  }
  @media(max-width:600px){
    .anh-text{font-size:13px;}
  }
  `;
  document.head.appendChild(style);

  /* ===============================
     BANNER CREATION
  =============================== */
  function showPolicyBand() {
    if (document.getElementById("anh-policy-band")) return;

    const band = document.createElement("div");
    band.id = "anh-policy-band";
    band.setAttribute("role", "navigation");
    band.setAttribute("aria-label", "Policy navigation banner");

    band.innerHTML = `
      <div class="anh-card">
        <div class="anh-text-group">
          <div class="anh-text">
            <b>${project.name}</b> uses a unified policy across all pages:
          </div>
          <a href="${project.termsUrl}" class="anh-btn secondary" target="_blank" rel="noopener">Terms</a>
          <a href="${project.privacyUrl}" class="anh-btn secondary" target="_blank" rel="noopener">Privacy</a>
          <a href="${project.manualUrl}" class="anh-btn secondary" target="_blank" rel="noopener">Manual</a>
        </div>
        <div class="anh-actions">
          ${
            POLICY_SETTINGS.enforce
              ? ""
              : `<button class="anh-close" aria-label="Dismiss policy banner">âœ–</button>`
          }
        </div>
      </div>
    `;

    (document.body || document.documentElement).appendChild(band);

    /* ===============================
       CLOSE HANDLER
    =============================== */
    if (!POLICY_SETTINGS.enforce) {
      const closeBtn = band.querySelector(".anh-close");
      if (closeBtn) {
        closeBtn.addEventListener("click", () => {
          band.remove();
          if (POLICY_SETTINGS.rememberDismiss) {
            localStorage.setItem(STORAGE_KEY, "true");
          }
        });
      }
    }
  }

  /* ===============================
     SHOW WITH DELAY
  =============================== */
  setTimeout(showPolicyBand, POLICY_SETTINGS.delay);
});